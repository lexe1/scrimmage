{% extends 'base.html' %}
{% block title %} Upload: {{ upload.title }}  {% endblock %}

{% block content %}  
<br><br>
<h5>Scrimmage stats for '{{ upload.title|safe }}'' upload :</h5>
<hr><br>
<p class="card-text">Uploaded on {{ upload.uploaded_on }} with {{ upload.file }}</p> 
<table id="myTable" class="table table-striped table-bordered text-center">
    <tr class="table-dark">
        <th onclick="sortTable(0)">#</th>
        <th onclick="sortTable(1)">Date</th>
        <th onclick="sortTable(2)">Player</th>
        <th onclick="sortTable(3)">MIN</th>
        <th onclick="sortTable(4)">2s</th>
        <th onclick="sortTable(5)">A 2s</th>
        <th onclick="sortTable(6)">3s</th>
        <th onclick="sortTable(7)">A 3s</th>
        <th onclick="sortTable(8)">FTs</th>
        <th onclick="sortTable(9)">A FT</th>
        <th onclick="sortTable(10)">REB O</th>
        <th onclick="sortTable(11)">REB D</th>
        <th onclick="sortTable(12)">A</th>
        <th onclick="sortTable(13)">POA</th>
        <th onclick="sortTable(14)">PF</th>
        <th onclick="sortTable(15)">FD</th>
        <th onclick="sortTable(16)">S</th>
        <th onclick="sortTable(17)">TO</th>
        <th onclick="sortTable(18)">B</th>
    </tr>
    {% for stat in queryset %}
    <tr>
        <td>{{ stat.id }}</td>
        <td>{{ stat.date|date:'m/d/y-h' }}</td>
        <td>{{ stat.player }}</td>
        <td>{{ stat.min }}</td>
        <td>{{ stat.made_2 }}</td>
        <td>{{ stat.attempts_2 }}</td>
        <td>{{ stat.made_3 }}</td>
        <td>{{ stat.attempts_3 }}</td>
        <td>{{ stat.made_ft }}</td>
        <td>{{ stat.attempts_ft }}</td>
        <td>{{ stat.reb_o }}</td>
        <td>{{ stat.reb_d }}</td>
        <td>{{ stat.assist }}</td>
        <td>{{ stat.poa }}</td>
        <td>{{ stat.pf }}</td>
        <td>{{ stat.fd }}</td>
        <td>{{ stat.turnovers }}</td>
<!-- Why?? -->
        <td>{{ stat.blocks }}</td>
        <td>{{ stat.blocks }}</td>
    </tr>
    {% endfor %}  
</table>
<button class="btn btn-danger" href="{% url 'delete-upload' upload.pk %}">Delete</button>
<br><br><br>
<script>
    function sortTable(n) {
  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
  table = document.getElementById("myTable");
  switching = true;
  //Set the sorting direction to ascending:
  dir = "asc"; 
  /*Make a loop that will continue until
  no switching has been done:*/
  while (switching) {
    //start by saying: no switching is done:
    switching = false;
    rows = table.rows;
    /*Loop through all table rows (except the
    first, which contains table headers):*/
    for (i = 1; i < (rows.length - 1); i++) {
      //start by saying there should be no switching:
      shouldSwitch = false;
      /*Get the two elements you want to compare,
      one from current row and one from the next:*/
      x = rows[i].getElementsByTagName("TD")[n];
      y = rows[i + 1].getElementsByTagName("TD")[n];
      /*check if the two rows should switch place,
      based on the direction, asc or desc:*/
      if (dir == "asc") {
        if (parseInt(x.innerHTML, 10) > parseInt(y.innerHTML, 10)) {
          //if so, mark as a switch and break the loop:
          shouldSwitch= true;
          break;
        }
      } else if (dir == "desc") {
        if (parseInt(x.innerHTML, 10) < parseInt(y.innerHTML, 10)) {
          //if so, mark as a switch and break the loop:
          shouldSwitch = true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      switchcount ++;      
    } else {
      /*If no switching has been done AND the direction is "asc",
      set the direction to "desc" and run the while loop again.*/
      if (switchcount == 0 && dir == "asc") {
        dir = "desc";
        switching = true;
      }
    }
  }
}
</script>
{% endblock %}
